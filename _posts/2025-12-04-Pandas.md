---
title: Pandas Basics
date: 2025-12-05 13:23:00 +0800
categories: [Python, Pandas]
tags: [notes] # TAG names should always be lowercase
author: zora
description: "Python package -- Pandas learning notes"
toc: true
comments: false
---

Notes were taken from [W3Schools](https://www.w3schools.com/python/pandas/default.asp)

> Pandas is an open source library built on top of NumPy. It allows for fast analysis and data cleaning and preparation. It also has built-in visualization features. It can work with data from a wide variety of sources. Simply speaking you can think of pandas as an extremely powerful version of Excel, with a lot more features.
{: .prompt-info}

## Pandas Series

- A Pandas Series is like a **column in a table**.
- It is a **one-dimensional** array holding data of any type.

``` python
import pandas as pd

a = [1, 7, 2]

myvar = pd.Series(a)

print(myvar)
# 0    1
# 1    7
# 2    2
# dtype: int64
```

### Labels

- If nothing else is specified, the values are labeled with their **index number**. First value has index 0, second value has index 1 etc.
- This label can be used to access a specified value.

``` python
import pandas as pd

a = [1, 7, 2]

myvar = pd.Series(a)

print(myvar[0])   # 1
```

### Create Labels  

With the `index` argument, you can name your own labels.  

```python
import pandas as pd

a = [1, 7, 2]

myvar = pd.Series(a, index = ["x", "y", "z"])

print(myvar)
# x    1
# y    7
# z    2
# dtype: int64
```

### Key/Value Objects as Series  

Can also use a **key/value object**, like a dictionary, when creating a Series.

```python
import pandas as pd

calories = {"day1": 420, "day2": 380, "day3": 390}

myvar = pd.Series(calories)

print(myvar)
# day1    420
# day2    380
# day3    390
# dtype: int64
```

> The keys of the dictionary become the labels
{: .prompt-tip}

To select only *some of the items* in the dictionary, use the `index` argument and specify only the items you want to include in the Series.

``` python
import pandas as pd

calories = {"day1": 420, "day2": 380, "day3": 390}

myvar = pd.Series(calories, index = ["day1", "day2"])

print(myvar)
# day1    420
# day2    380
# dtype: int64
```

## Pandas DataFrames  

Data sets in Pandas are usually multi-dimensional tables, called DataFrames.  
> Series is like a column, a DataFrame is the whole table.

> *detailed DataFrame API reference: [pandas.DataFrame](https://pandas.pydata.org/docs/reference/frame.html)*
{: .prompt-tip}

``` python
import pandas as pd

data = {
  "calories": [420, 380, 390],
  "duration": [50, 40, 45]
}

df = pd.DataFrame(data)

print(df)
#    calories  duration
# 0       420        50
# 1       380        40
# 2       390        45
```

### Locate Row

Pandas use the `loc` attribute to return one or more specified row(s)

``` python
import pandas as pd

data = {
  "calories": [420, 380, 390],
  "duration": [50, 40, 45]
}

df = pd.DataFrame(data)

# Return row 0: (this returns a pandas series)
print(df.loc[0])
# calories    420
# duration     50
# Name: 0, dtype: int64



# Return row 0 and 1: (when using [], the result is a pandas dataframe)
print(df.loc[[0, 1]])
#    calories  duration
# 0       420        50
# 1       380        40
```

### Named Indexes

Name your own indexes with the `index` argument

```python
import pandas as pd

data = {
  "calories": [420, 380, 390],
  "duration": [50, 40, 45]
}

df = pd.DataFrame(data, index = ["day1", "day2", "day3"])

print(df)
#       calories  duration
# day1       420        50
# day2       380        40
# day3       390        45

print(df.loc["day2"])
# calories    380
# duration     40
# Name: day2, dtype: int64
```

### Get Column Datas

To get data in specific column, use square bracket

``` python
import pandas as pd
cars = pd.read_csv('cars.csv', index_col = 0)

print(cars['country'])
print(cars[['country']])

print(cars[['country', 'drives_right']])    # multiple columns
```

> - ***single bracket***: returns a Pandas Series
> - ***double bracket***: returns a Pandas DataFrame
{: .prompt-tip}

## Load Files Into a DataFrame

### Read CSV Files

```python
import pandas as pd

df = pd.read_csv('data.csv')

print(df) # when dataframe have many rows, pandas will only return first and last 5 rows

print(df.to_string()) # print the entire dataframe
```

**max_rows**: Check your system's maximum rows with the `pd.options.display.max_rows` statement.

``` python
import pandas as pd

print(pd.options.display.max_rows) 
```

> for example, the max_rows is 60, which means that if the DataFrame contains more than 60 rows, the `print(df)` will return only the headers and the first and last 5 rows.
{: .prompt-info}  
> You can change the maximum rows number with the same statement.
{: .prompt-tip}

### Read JSON Files

```python
import pandas as pd

df = pd.read_json('data.json')

print(df.to_string())   # print entire dataframe
```

#### Dictionary as JSON

> JSON objects have the same format as Python dictionaries

``` python
import pandas as pd

data = {
  "Duration":{
    "0":60,
    "1":60,
    "2":60,
    "3":45,
    "4":45,
    "5":60
  },
  "Pulse":{
    "0":110,
    "1":117,
    "2":103,
    "3":109,
    "4":117,
    "5":102
  },
  "Maxpulse":{
    "0":130,
    "1":145,
    "2":135,
    "3":175,
    "4":148,
    "5":127
  },
  "Calories":{
    "0":409,
    "1":479,
    "2":340,
    "3":282,
    "4":406,
    "5":300
  }
}

df = pd.DataFrame(data)

print(df) 
#    Duration  Pulse  Maxpulse  Calories
# 0        60    110       130     409.1
# 1        60    117       145     479.0
# 2        60    103       135     340.0
# 3        45    109       175     282.4
# 4        45    117       148     406.0
# 5        60    102       127     300.5
```

## Analyzing Data

### Viewing the Data

- The `head()` method returns the **headers** and a **specified number of rows**, starting from the top.

  ```python
  import pandas as pd

  df = pd.read_csv('data.csv')

  print(df.head(10))    # return the first 10 rows of the DataFrame
  ```

  > if the number of rows is not specified, the `head()` method will return the **top 5 rows**
  {: .prompt-tip}

- The `tail()` method returns the headers and a specified number of rows, starting from the bottom.

  ``` python
  import pandas as pd

  df = pd.read_csv('data.csv')

  print(df.tail())    # return the last 5 rows of the DataFrame
  ```

### Info About the Data

The DataFrames object has a method called `info()`, that gives you more information about the data set.

``` python
import pandas as pd

df = pd.read_csv('data.csv')

print(df.info())  # print information about the data
# example output:
#  <class 'pandas.core.frame.DataFrame'>
#   RangeIndex: 169 entries, 0 to 168
#   Data columns (total 4 columns):
#    #   Column    Non-Null Count  Dtype  
#   ---  ------    --------------  -----  
#    0   Duration  169 non-null    int64  
#    1   Pulse     169 non-null    int64  
#    2   Maxpulse  169 non-null    int64  
#    3   Calories  164 non-null    float64
#   dtypes: float64(1), int64(3)
#   memory usage: 5.4 KB
#   None
```

## Cleaning Data

Data cleaning means **fixing bad data** in your data set.

Bad data could be:

- Empty cells
- Data in wrong format
- Wrong data
- Duplicates

### Cleaning Empty Cells

1. Remove empty rows: `dropna()`

    ```python

    import pandas as pd

    df = pd.read_csv('data.csv')

    new_df = df.dropna()

    ```

    > by default, the `dropna()` method returns a **new DataFrame**, and will not change the original. If want to change the original DataFrame, use the `inplace = True` argument.
    {: .prompt-tip}

2. Replace empty values: `fillna()`

   ``` python
   import pandas as pd

   df = pd.read_csv('data.csv')

   df.fillna(130, inplace = True)   # Replace NULL values with the number 130

   # Replace only for specified columns:
   df.fillna({"Calories": 130}, inplace=True)   # Replace NULL values in the "Calories" columns with the number 130
   ```

3. Replace using Mean, Median or Mode: `mean()`, `median()`, `mode()`

   ``` python
   import pandas as pd

   df = pd.read_csv('data.csv')
   m
   # Calculate the MEAN, and replace any empty values with it:
   x = df["Calories"].mean()

   df.fillna({"Calories": x}, inplace=True)
   ```

### Cleaning Wrong Format

To fix it, either remove the rows or convert all cells in the columns into the same format.

``` python
import pandas as pd

df = pd.read_csv('data.csv')

# Convert to date
df['Date'] = pd.to_datetime(df['Date'], format='mixed')

print(df.to_string())
```

### Fixing Wrong Data

1. Replacing Values
   - replace single value

      ``` python
      import pandas as pd

      df = pd.read_csv('data.csv')

      # Set "Duration" = 45 in row 7:
      df.loc[7, 'Duration'] = 45
      ```

   - replace data with conditions

     ``` python
     for x in df.index:
      # if the value is higher than 120, set it to 120:
      if df.loc[x, "Duration"] > 120:
        df.loc[x, "Duration"] = 120
     ```

2. Removing rows: `drop()`

     ``` python
     for x in df.index:
      # delete rows where "Duration" is higher than 120:
      if df.loc[x, "Duration"] > 120:
        df.drop(x, inplace = True)
     ```

### Removing Duplicates

- To discover duplicates, use the `duplicated()` method.

  > `duplicated()` returns `True` for every row that is dup;ocate, otherwise `False`
  {: .prompt-tip}

  ``` python
  print(df.duplicated())
  ```

- To remove duplicates, use the `drop_duplicates()` method.

  ``` python
  df.drop_duplicates(inplace = True)
  ```

## GroupBy Operations

GroupBy operations involve **splitting** data into groups, **applying** a function, and **combining** results. Similar to SQL's GROUP BY or Excel's Pivot Table.

```python
# Calculate average sales for each company
df.groupby('Company').mean(numeric_only=True).reset_index()
```

> `reset_index()` is used to make the group column a regular column
{: .prompt-tip}

## DataFrame Methods

[Pandas API Reference](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html)

## Correlations

The `corr()` method calculates the relationship between each column in your data set.

> The `corr()` method ignores non numeric columns
{: .prompt-tip}

## Plotting

Pandas uses the `plot()` method to create diagrams

> We can use Pyplot, a submodule of the Matplotlib library to visualize the diagram on the screen

``` python
import pandas as pd
import matplotlib.pyplot as plt

df = pd.read_csv('data.csv')

df.plot()

plt.show()
```

### Specify type of plot

The `kind` argument is used to specify type of plot

Common plot `kind` options:

- `line`: the **default**, line graph
- `bar`: vertical bar graph
- `barh`: horizontal bar graph
- `hist`: histogram
- `box`: box plot
- `kde`: Kernel Density Estimate plot
- `area`: area plot
- `pie`: pie chart
- `scatter`: scatter plot
- `hexbin`: hexagonal bin plot

``` python
import pandas as pd
import matplotlib.pyplot as plt

df = pd.read_csv('data.csv')

# Scatter plot
df.plot(kind = 'scatter', x = 'Duration', y = 'Calories')

# Histogram created using "duration" column
df["Duration"].plot(kind = 'hist')
plt.show()
```
